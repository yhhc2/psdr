<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples • psdr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples">
<meta property="og:description" content="psdr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psdr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Examples.html">Examples</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Examples_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Examples</h1>
            
      
      
      <div class="hidden name"><code>Examples.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>Author: Yong-Han Hank Cheng</p>
<p>This package allows you to generate and compare power spectral density (PSD) plots given time series data. FFT is used to take a time series data, analyze the oscillations, and then output the frequencies of these oscillations in the time series in the form of a PSD plot.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Install the package from GitHub</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"yhhc2/psdr"</span><span class="op">)</span></code></pre></div>
<pre><code>## glue     (1.4.1  -&gt; 1.4.2 ) [CRAN]
## fansi    (0.4.1  -&gt; 0.5.0 ) [CRAN]
## tibble   (3.1.1  -&gt; 3.1.2 ) [CRAN]
## ps       (1.3.4  -&gt; 1.6.0 ) [CRAN]
## jsonlite (1.7.0  -&gt; 1.7.2 ) [CRAN]
## digest   (0.6.25 -&gt; 0.6.27) [CRAN]
## curl     (4.3    -&gt; 4.3.1 ) [CRAN]
## xfun     (0.22   -&gt; 0.23  ) [CRAN]
## stringi  (1.4.6  -&gt; 1.6.2 ) [CRAN]
## Rcpp     (1.0.5  -&gt; 1.0.6 ) [CRAN]
## cachem   (1.0.4  -&gt; 1.0.5 ) [CRAN]
## 
##   There are binary versions available but the source versions are later:
##         binary source needs_compilation
## fansi    0.4.2  0.5.0              TRUE
## tibble   3.1.1  3.1.2              TRUE
## stringi  1.5.3  1.6.2              TRUE
## 
##   Binaries will be installed
## package 'glue' successfully unpacked and MD5 sums checked
## package 'fansi' successfully unpacked and MD5 sums checked
## package 'tibble' successfully unpacked and MD5 sums checked
## package 'ps' successfully unpacked and MD5 sums checked
## package 'jsonlite' successfully unpacked and MD5 sums checked
## package 'digest' successfully unpacked and MD5 sums checked
## package 'curl' successfully unpacked and MD5 sums checked
## package 'xfun' successfully unpacked and MD5 sums checked
## package 'stringi' successfully unpacked and MD5 sums checked
## package 'Rcpp' successfully unpacked and MD5 sums checked
## package 'cachem' successfully unpacked and MD5 sums checked
## 
## The downloaded binary packages are in
##  C:\Users\hankc\AppData\Local\Temp\Rtmp6RQ2W7\downloaded_packages
##   
  
  
   checking for file 'C:\Users\hankc\AppData\Local\Temp\Rtmp6RQ2W7\remotesc87c4da526cd\yhhc2-psdr-8667f34/DESCRIPTION' ...
  
v  checking for file 'C:\Users\hankc\AppData\Local\Temp\Rtmp6RQ2W7\remotesc87c4da526cd\yhhc2-psdr-8667f34/DESCRIPTION'
## 
  
  
  
-  preparing 'psdr': (1.5s)
##    checking DESCRIPTION meta-information ...
  
   checking DESCRIPTION meta-information ... 
  
v  checking DESCRIPTION meta-information
## 
  
  
  
-  checking for LF line-endings in source and make files and shell scripts
## 
  
  
  
-  checking for empty or unneeded directories
## 
  
  
  
-  building 'psdr_1.0.0.tar.gz'
## 
  
   
## </code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"psdr"</span><span class="op">)</span></code></pre></div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>All functions with example code is run in this section. The functions are listed below in alphabetical order with example code to illustrate how each function should be used. The example code should be very similar to the example code in the function reference.</p>
<p>To see detailed descriptions for each function, please visit the package’s website.</p>
<div id="automatedcompositeplotting" class="section level3">
<h3 class="hasAnchor">
<a href="#automatedcompositeplotting" class="anchor"></a>AutomatedCompositePlotting()</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#I want to create a plot that shows two curves:</span>
<span class="co">#1. Composite of time series signals 1, 2, and 3.</span>
<span class="co">#2. Composite of time series signals 3 and 4.</span>

<span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -4</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fourth signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="va">S4</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">S4.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S4</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="va">windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span>, <span class="va">S4.data.frame</span><span class="op">)</span>

<span class="co">#Gets the composite of the first, second, and third signal. Should result in a flat signal.</span>
<span class="va">FirstComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">)</span>

<span class="co">#Gets the composite of the third and fourth signal</span>
<span class="va">SecondComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>


<span class="co">#Timeseries-----------------------------------------------------------------</span>

<span class="va">timeseries.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">999</span>,
                           x_increment <span class="op">=</span> <span class="fl">1</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Time"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"Original units"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="cn">NULL</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"TimeSeries"</span>,
                           sampling_frequency <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 1
## [1] 2</code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.timeseries</span> <span class="op">&lt;-</span> <span class="va">timeseries.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot. Will see the 1+2+3 curve as a flat line. The 3+4 curve will only have 2 Hz.</span>
<span class="co">#dev.new()</span>
<span class="va">ggplot.obj.timeseries</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#PSD-------------------------------------------------------------------------</span>

<span class="co">#Note that the PSDs are not generated directly from the "Signal 1 + 2 + 3" and</span>
<span class="co">#the "Signal 3 + 4" time series. Instead, PSDs are generated individually</span>
<span class="co">#for signals 1, 2, 3, and 4, and then then are summed together. </span>

<span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">50</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 1
## [1] 2
## [1] 1
## [1] 2
## [1] 3
## [1] 1
## [1] 2</code></pre>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should be</span>
<span class="co">#stronger in both cases because more signals have this frequency (even if amp is negative).</span>
<span class="co">#Error envelope is specified for the second (red) curve. Envelope should only</span>
<span class="co">#be present for 2 Hz signal.</span>
<span class="co">#dev.new()</span>
<span class="va">ggplot.obj.PSD</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="co">#PSD Zoomed in---------------------------------------------------------------</span>

 <span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                            name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                            x_start <span class="op">=</span> <span class="fl">0</span>,
                            x_end <span class="op">=</span> <span class="fl">5</span>,
                            x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                            level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                            level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                            level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
                            level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
                            plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                            plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                            plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                            combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                            TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                            sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 1
## [1] 2
## [1] 1
## [1] 2
## [1] 3
## [1] 1
## [1] 2</code></pre>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

 <span class="co">#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should be</span>
 <span class="co">#stronger in both cases because more signals have this frequency (even if amp is negative).</span>
 <span class="co">#Error envelope is specified for the second (red) curve. Envelope should only</span>
 <span class="co">#be present for 2 Hz signal.</span>
 <span class="co">#dev.new()</span>
 <span class="va">ggplot.obj.PSD</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#LogPSD-------------------------------------------------------------------------</span>

<span class="va">LogPSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">50</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"log((Original units)^2/Hz)"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="cn">NULL</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"LogPSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 1
## [1] 2</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.LogPSD</span> <span class="op">&lt;-</span> <span class="va">LogPSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should</span>
<span class="co">#be stronger in both cases because more signals have this frequency (even if amp is negative).</span>
<span class="co">#Error envelope is specified for the second (red) curve. Envelope should only</span>
<span class="co">#be present for 1 Hz signal.</span>
<span class="co">#dev.new()</span>
<span class="va">ggplot.obj.LogPSD</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-3-4.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Are dominant frequencies different---------------------------------------------</span>
<span class="va">comparison_results</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Table used for statistical testing</span>
<span class="va">comparison_results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>##   vals.to.compare.combined combo.labels.combined
## 1                        1           Signal1+2+3
## 2                        1           Signal1+2+3
## 3                        2           Signal1+2+3
## 4                        2             Signal3+4
## 5                        1             Signal3+4</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Kruskal Wallis results</span>
<span class="va">comparison_results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  vals.to.compare.combined by combo.labels.combined
## Kruskal-Wallis chi-squared = 0.11111, df = 1, p-value = 0.7389</code></pre>
</div>
<div id="countwindows" class="section level3">
<h3 class="hasAnchor">
<a href="#countwindows" class="anchor"></a>CountWindows()</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Example using a dataframe with 5 homogeneous windows.</span>

<span class="co">#Windows are homogeneous if looking at col.two and col.three values.</span>
<span class="va">window.name.column</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>
<span class="va">col.two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span>
<span class="va">col.three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>

<span class="va">multi.window.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">window.name.column</span>, <span class="va">col.two</span>, <span class="va">col.three</span><span class="op">)</span>

<span class="va">list.of.homogeneous.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetHomogeneousWindows.html">GetHomogeneousWindows</a></span><span class="op">(</span><span class="va">multi.window.data</span>,
<span class="st">"window.name.column"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"col.two"</span>, <span class="st">"col.three"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CountWindows.html">CountWindows</a></span><span class="op">(</span><span class="va">list.of.homogeneous.windows</span>, <span class="st">"col.two"</span>, <span class="st">"col.three"</span>,
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span><span class="op">)</span><span class="op">)</span>

<span class="va">matrix</span></code></pre></div>
<pre><code>##   1 2 3
## a 2 1 1
## b 1 0 0</code></pre>
</div>
<div id="findhomogeneouswindows" class="section level3">
<h3 class="hasAnchor">
<a href="#findhomogeneouswindows" class="anchor"></a>FindHomogeneousWindows()</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">col.one</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>
<span class="va">col.two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span>
<span class="va">col.three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">single.window.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">col.one</span>, <span class="va">col.two</span>, <span class="va">col.three</span><span class="op">)</span>

<span class="co">#Example of inhomogeneous window if looking at col.one and col.two because</span>
<span class="co">#col.one does not only have a single unique value.</span>
<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FindHomogeneousWindows.html">FindHomogeneousWindows</a></span><span class="op">(</span><span class="va">single.window.data</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"col.one"</span>, <span class="st">"col.two"</span><span class="op">)</span><span class="op">)</span>

<span class="va">result</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Example of homogeneous window if looking at col.two and col.three because</span>
<span class="co">#col.two and col.three both only have a single unique value.</span>
<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FindHomogeneousWindows.html">FindHomogeneousWindows</a></span><span class="op">(</span><span class="va">single.window.data</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"col.two"</span>, <span class="st">"col.three"</span><span class="op">)</span><span class="op">)</span>

<span class="va">result</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="gethomogeneouswindows" class="section level3">
<h3 class="hasAnchor">
<a href="#gethomogeneouswindows" class="anchor"></a>GetHomogeneousWindows</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Example using a dataframe with 3 windows.</span>

<span class="co">#Windows 20 and 30 are homogeneous if looking at col.two and col.three values.</span>
<span class="va">window.name.column</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span><span class="op">)</span>
<span class="va">col.two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span>
<span class="va">col.three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>

<span class="va">multi.window.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">window.name.column</span>, <span class="va">col.two</span>, <span class="va">col.three</span><span class="op">)</span>

<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetHomogeneousWindows.html">GetHomogeneousWindows</a></span><span class="op">(</span><span class="va">multi.window.data</span>, <span class="st">"window.name.column"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"col.two"</span>, <span class="st">"col.three"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3</code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#As expected, it looks like two windows are homogeneous.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 2
##  $ :'data.frame':    3 obs. of  3 variables:
##   ..$ window.name.column: num [1:3] 20 20 20
##   ..$ col.two           : chr [1:3] "a" "a" "a"
##   ..$ col.three         : num [1:3] 1 1 1
##  $ :'data.frame':    4 obs. of  3 variables:
##   ..$ window.name.column: num [1:4] 30 30 30 30
##   ..$ col.two           : chr [1:4] "a" "a" "a" "a"
##   ..$ col.three         : num [1:4] 2 2 2 2</code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>##   window.name.column col.two col.three
## 4                 20       a         1
## 5                 20       a         1
## 6                 20       a         1</code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>##    window.name.column col.two col.three
## 7                  30       a         2
## 8                  30       a         2
## 9                  30       a         2
## 10                 30       a         2</code></pre>
</div>
<div id="getsubsetofwindows" class="section level3">
<h3 class="hasAnchor">
<a href="#getsubsetofwindows" class="anchor"></a>GetSubsetOfWindows()</h3>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Example using a dataframe with 3 windows.</span>

<span class="co">#Windows 20 and 30 are homogeneous if looking at col.two and col.three values.</span>
<span class="va">window.name.column</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span><span class="op">)</span>
<span class="va">col.two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span>
<span class="va">col.three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>

<span class="va">multi.window.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">window.name.column</span>, <span class="va">col.two</span>, <span class="va">col.three</span><span class="op">)</span>

<span class="va">list.of.homogeneous.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetHomogeneousWindows.html">GetHomogeneousWindows</a></span><span class="op">(</span><span class="va">multi.window.data</span>,
<span class="st">"window.name.column"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"col.two"</span>, <span class="st">"col.three"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Get a subset of windows where col.three has a value of 2</span>
<span class="va">subset.list.of.homogeneous.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetSubsetOfWindows.html">GetSubsetOfWindows</a></span><span class="op">(</span><span class="va">list.of.homogeneous.windows</span>,
<span class="st">"col.three"</span>, <span class="st">"2"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">subset.list.of.homogeneous.windows</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 1
##  $ :'data.frame':    4 obs. of  3 variables:
##   ..$ window.name.column: num [1:4] 30 30 30 30
##   ..$ col.two           : chr [1:4] "a" "a" "a" "a"
##   ..$ col.three         : num [1:4] 2 2 2 2</code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">subset.list.of.homogeneous.windows</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>##    window.name.column col.two col.three
## 7                  30       a         2
## 8                  30       a         2
## 9                  30       a         2
## 10                 30       a         2</code></pre>
</div>
<div id="getsubsetofwindowstwolevels" class="section level3">
<h3 class="hasAnchor">
<a href="#getsubsetofwindowstwolevels" class="anchor"></a>GetSubsetOfWindowsTwoLevels()</h3>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Example using a dataframe with 5 homogeneous windows.</span>

<span class="co">#Windows are homogeneous if looking at col.two and col.three values.</span>
<span class="va">window.name.column</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>
<span class="va">col.two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span>
<span class="va">col.three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>

<span class="va">multi.window.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">window.name.column</span>, <span class="va">col.two</span>, <span class="va">col.three</span><span class="op">)</span>

<span class="va">list.of.homogeneous.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetHomogeneousWindows.html">GetHomogeneousWindows</a></span><span class="op">(</span><span class="va">multi.window.data</span>,
<span class="st">"window.name.column"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"col.two"</span>, <span class="st">"col.three"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5</code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetSubsetOfWindowsTwoLevels.html">GetSubsetOfWindowsTwoLevels</a></span><span class="op">(</span><span class="va">list.of.homogeneous.windows</span>, <span class="st">"col.two"</span>, <span class="st">"col.three"</span>,
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span><span class="op">)</span><span class="op">)</span>

<span class="co">#Should contain windows 10, 20, 30 because col.two is "a" and col.three can be "1" or "2"</span>
<span class="va">result</span></code></pre></div>
<pre><code>## [[1]]
##   window.name.column col.two col.three
## 1                 10       a         1
## 2                 10       a         1
## 3                 10       a         1
## 
## [[2]]
##   window.name.column col.two col.three
## 4                 20       a         1
## 5                 20       a         1
## 6                 20       a         1
## 
## [[3]]
##    window.name.column col.two col.three
## 7                  30       a         2
## 8                  30       a         2
## 9                  30       a         2
## 10                 30       a         2</code></pre>
</div>
<div id="identifymaxonxy" class="section level3">
<h3 class="hasAnchor">
<a href="#identifymaxonxy" class="anchor"></a>IdentifyMaxOnXY()</h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#I want to create a plot that shows two curves:</span>
<span class="co">#1. Composite of time series signals 1, 2, and 3.</span>
<span class="co">#2. Composite of time series signals 3 and 4.</span>

<span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -4</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fourth signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="va">S4</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">S4.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S4</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Extra representation of S2 dataframe to show an example that has enough samples</span>
<span class="co">#to have significance for Kruskal-Wallis test</span>
<span class="va">windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>,
<span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span>,
<span class="va">S4.data.frame</span><span class="op">)</span>

<span class="co">#Gets the composite of the first, second, and third signal. Should result in a flat signal.</span>
<span class="va">FirstComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">)</span>

<span class="co">#Gets the composite of the third and fourth signal</span>
<span class="va">SecondComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>


<span class="co">#PSD-------------------------------------------------------------------------</span>

<span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">10</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10
## [1] 11
## [1] 1
## [1] 2
## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10
## [1] 11
## [1] 1
## [1] 2</code></pre>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot</span>
<span class="va">ggplot.obj.PSD</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataframes.plotted</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">first.curve</span> <span class="op">&lt;-</span> <span class="va">dataframes.plotted</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">second.curve</span> <span class="op">&lt;-</span> <span class="va">dataframes.plotted</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Identify maximum</span>
<span class="va">first.curve.max</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IdentifyMaxOnXY.html">IdentifyMaxOnXY</a></span><span class="op">(</span><span class="va">first.curve</span><span class="op">$</span><span class="va">xvals</span>, <span class="va">first.curve</span><span class="op">$</span><span class="va">yvals</span>, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="va">second.curve.max</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IdentifyMaxOnXY.html">IdentifyMaxOnXY</a></span><span class="op">(</span><span class="va">second.curve</span><span class="op">$</span><span class="va">xvals</span>, <span class="va">second.curve</span><span class="op">$</span><span class="va">yvals</span>, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>

<span class="va">first.curve.max</span></code></pre></div>
<pre><code>##     xval       yval
## 101    1 0.06909091</code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">second.curve.max</span></code></pre></div>
<pre><code>##     xval yval
## 101    1 0.02</code></pre>
</div>
<div id="makecompositepsdforallwindows" class="section level3">
<h3 class="hasAnchor">
<a href="#makecompositepsdforallwindows" class="anchor"></a>MakeCompositePSDForAllWindows()</h3>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 10 Hz with amplitude of 4</span>
<span class="co">#2. 25 Hz with amplitude of 4</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">25</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="va">S1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="co">#Add some noise</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 5 Hz with amplitude of 2</span>
<span class="co">#2. 8 Hz with amplitude of 2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">5</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">8</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="va">S2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="co">#Add some noise</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 5 Hz with amplitude of 2</span>
<span class="co">#2. 8 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">5</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">8</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="va">S3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="co">#Add some noise</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Add all signals to a List</span>
<span class="va">list.of.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span><span class="op">)</span>

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MakeCompositePSDForAllWindows.html">MakeCompositePSDForAllWindows</a></span><span class="op">(</span><span class="va">list.of.windows</span>, <span class="st">"Signal"</span>, <span class="va">Fs</span>, <span class="fl">0</span>, <span class="fl">30</span>, <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">frequencies</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">averaged.PSD</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="va">stddev.PSD</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">frequencies</span>, <span class="va">averaged.PSD</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="makecompositexyplotforallwindows" class="section level3">
<h3 class="hasAnchor">
<a href="#makecompositexyplotforallwindows" class="anchor"></a>MakeCompositeXYPlotForAllWindows</h3>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 4</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Add all signals to a List</span>
<span class="va">list.of.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span><span class="op">)</span>

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MakeCompositeXYPlotForAllWindows.html">MakeCompositeXYPlotForAllWindows</a></span><span class="op">(</span><span class="va">list.of.windows</span>, <span class="st">"Signal"</span>, <span class="fl">0</span>, <span class="fl">999</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3</code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x.values</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">y.values</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="va">stddev.y.values</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>

<span class="co">#plot each xy plot individually</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plot the averaged plot</span>
<span class="co">#The only curve remaining should be the 1Hz with amplitude of 4/3.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x.values</span>, <span class="va">y.values</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
</div>
<div id="makeonesidedamplitudespectrum" class="section level3">
<h3 class="hasAnchor">
<a href="#makeonesidedamplitudespectrum" class="anchor"></a>MakeOneSidedAmplitudeSpectrum()</h3>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#Form a signal (time series) that contains two frequencies:</span>
<span class="co">#1. 10 Hz with amplitude of 1</span>
<span class="co">#2. 25 Hz with amplitude of 2</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">25</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MakeOneSidedAmplitudeSpectrum.html">MakeOneSidedAmplitudeSpectrum</a></span><span class="op">(</span><span class="va">Fs</span>, <span class="va">S</span><span class="op">)</span>

<span class="va">frequencies</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">amplitudes</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#dev.new()</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">frequencies</span>, <span class="va">amplitudes</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div id="makepowerspectraldensity" class="section level3">
<h3 class="hasAnchor">
<a href="#makepowerspectraldensity" class="anchor"></a>MakePowerSpectralDensity()</h3>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz (sampling/second)</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector in seconds</span>

<span class="co">#Form a signal (time series) that contains two frequencies:</span>
<span class="co">#1. 10 Hz with amplitude of 1</span>
<span class="co">#2. 25 Hz with amplitude of 2</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">25</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;

<span class="co">#Plot the signal</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">t</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span>, <span class="va">S</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Make a PSD to see the frequencies in the signal</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MakePowerSpectralDensity.html">MakePowerSpectralDensity</a></span><span class="op">(</span><span class="va">Fs</span>, <span class="va">S</span><span class="op">)</span>

<span class="va">frequencies</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">PSD</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#dev.new()</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">frequencies</span>, <span class="va">PSD</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
</div>
<div id="psddominantfrequencyformultiplewindows" class="section level3">
<h3 class="hasAnchor">
<a href="#psddominantfrequencyformultiplewindows" class="anchor"></a>PSDDominantFrequencyForMultipleWindows()</h3>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -4</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fourth signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="va">S4</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">S4.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S4</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="va">windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span>, <span class="va">S4.data.frame</span><span class="op">)</span>

<span class="co">#Plot the PSD for each window</span>
<span class="va">FirstComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span>
<span class="va">SecondComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span>
<span class="va">ThirdComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>
<span class="va">FourthComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>
<span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">5</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span>, 
                                                     <span class="va">ThirdComboToUse</span>, <span class="va">FourthComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 1"</span>, <span class="st">"Signal 2"</span>, 
                                                         <span class="st">"Signal 3"</span>, <span class="st">"Signal 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 1
## [1] 1
## [1] 1
## [1] 1
## [1] 1
## [1] 1
## [1] 1</code></pre>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot</span>
<span class="va">ggplot.obj.PSD</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Calculate the dominant frequency for each window</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PSDDominantFrequencyForMultipleWindows.html">PSDDominantFrequencyForMultipleWindows</a></span><span class="op">(</span><span class="va">windows</span>, <span class="st">"Signal"</span>, <span class="va">Fs</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0.01</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4</code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span></code></pre></div>
<pre><code>## [1] 1 1 2 1</code></pre>
</div>
<div id="psdidentifydominantfrequency" class="section level3">
<h3 class="hasAnchor">
<a href="#psdidentifydominantfrequency" class="anchor"></a>PSDIdentifyDominantFrequency()</h3>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PSDIdentifyDominantFrequency.html">PSDIdentifyDominantFrequency</a></span><span class="op">(</span><span class="va">Fs</span>, <span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>

<span class="va">results</span></code></pre></div>
<pre><code>##     xval yval
## 101    1 0.02</code></pre>
</div>
<div id="psdintegrationperfreqbin" class="section level3">
<h3 class="hasAnchor">
<a href="#psdintegrationperfreqbin" class="anchor"></a>PSDIntegrationPerFreqBin()</h3>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#Form a signal (time series) that contains two frequencies:</span>
<span class="co">#1. 10 Hz with amplitude of 1</span>
<span class="co">#2. 25 Hz with amplitude of 2</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">25</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MakePowerSpectralDensity.html">MakePowerSpectralDensity</a></span><span class="op">(</span><span class="va">Fs</span>, <span class="va">S</span><span class="op">)</span>

<span class="va">frequencies</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">PSD</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">frequencies</span>, <span class="va">PSD</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">11</span><span class="op">)</span>,
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">24</span>,<span class="fl">26</span><span class="op">)</span>,
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">26</span><span class="op">)</span>,
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">40</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">integration.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PSDIntegrationPerFreqBin.html">PSDIntegrationPerFreqBin</a></span><span class="op">(</span><span class="va">Fs</span>, <span class="va">S</span>, <span class="va">bins</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">integration.results</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>

   <span class="va">message</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Area in bin "</span>, <span class="va">integration.results</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">" is "</span>,
                   <span class="va">integration.results</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>

   <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">message</span><span class="op">)</span>

<span class="op">}</span></code></pre></div>
<pre><code>## [1] "Area in bin  9 - 11  is  0.00050011493570859"
## [1] "Area in bin  24 - 26  is  0.00200024756472286"
## [1] "Area in bin  9 - 26  is  0.00249982073718224"
## [1] "Area in bin  30 - 40  is  1.40556982936425e-30"</code></pre>
</div>
<div id="singlebinpsdintegrationformultiplewindows" class="section level3">
<h3 class="hasAnchor">
<a href="#singlebinpsdintegrationformultiplewindows" class="anchor"></a>SingleBinPSDIntegrationForMultipleWindows()</h3>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -4</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fourth signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="va">S4</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">S4.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S4</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="va">windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span>, <span class="va">S4.data.frame</span><span class="op">)</span>

<span class="co">#Plot the PSD for each window</span>
<span class="va">FirstComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span>
<span class="va">SecondComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span>
<span class="va">ThirdComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>
<span class="va">FourthComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>
<span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">5</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span>, 
                                                     <span class="va">ThirdComboToUse</span>, <span class="va">FourthComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 1"</span>, <span class="st">"Signal 2"</span>, 
                                                         <span class="st">"Signal 3"</span>, <span class="st">"Signal 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 1
## [1] 1
## [1] 1
## [1] 1
## [1] 1
## [1] 1
## [1] 1</code></pre>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot</span>
<span class="va">ggplot.obj.PSD</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#For each of the 4 windows, calculate the area under the PSD from 0-2 Hz</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SingleBinPSDIntegrationForMultipleWindows.html">SingleBinPSDIntegrationForMultipleWindows</a></span><span class="op">(</span><span class="va">windows</span>, <span class="st">"Signal"</span>, <span class="va">Fs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4</code></pre>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span></code></pre></div>
<pre><code>## [1] 0.002000248 0.009000239 0.003000262 0.002000248</code></pre>
</div>
<div id="singlebinpsdintegrationordominantfreqcomparison" class="section level3">
<h3 class="hasAnchor">
<a href="#singlebinpsdintegrationordominantfreqcomparison" class="anchor"></a>SingleBinPSDIntegrationOrDominantFreqComparison()</h3>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -4</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fourth signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="va">S4</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">S4.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S4</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fifth signal</span>
<span class="co">#1. 5 Hz with amplitude of -2</span>
<span class="va">S5</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">5</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S5</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S5</span><span class="op">)</span><span class="op">)</span>
<span class="va">S5.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S5</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">S5.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S5.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">S5.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Extra representation of S2 dataframe to show an example that has enough samples</span>
<span class="co">#to have significance for Kruskal-Wallis test</span>
<span class="va">windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>,
<span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span>,
<span class="va">S4.data.frame</span>,
<span class="va">S5.data.frame</span>, <span class="va">S5.data.frame</span>, <span class="va">S5.data.frame</span>, <span class="va">S5.data.frame</span>, <span class="va">S5.data.frame</span><span class="op">)</span>

<span class="co">#Gets the composite of the first, second, and third signal. Should result in a flat signal.</span>
<span class="va">FirstComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">)</span>

<span class="co">#Gets the composite of the third and fourth signal</span>
<span class="va">SecondComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>

<span class="co">#Gets the composite of fifth signal</span>
<span class="va">ThirdComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span>


<span class="co">#PSD-------------------------------------------------------------------------</span>

<span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">10</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>,
                                                    <span class="va">SecondComboToUse</span>,
                                                    <span class="va">ThirdComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>,
                                                         <span class="st">"Signal 3 + 4"</span>,
                                                         <span class="st">"Signal 5"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10
## [1] 11
## [1] 1
## [1] 2
## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10
## [1] 11
## [1] 1
## [1] 2
## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5</code></pre>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="va">ggplot.obj.PSD</span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Integration-------------------------------------------------------------------------</span>

<span class="co">#Compare integration for the 1.5-2.5 Hz bin. P-value should not indicate</span>
<span class="co">#significant difference</span>
<span class="va">integration.compare.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SingleBinPSDIntegrationOrDominantFreqComparison.html">SingleBinPSDIntegrationOrDominantFreqComparison</a></span><span class="op">(</span>
list.of.windows <span class="op">=</span> <span class="va">windows</span>,
name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
sampling_frequency <span class="op">=</span> <span class="fl">100</span>,
single.bin.boundary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2.5</span><span class="op">)</span>,
integration.or.dominant.freq <span class="op">=</span> <span class="st">"integration"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10
## [1] 11
## [1] 1
## [1] 2</code></pre>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Kruskal-Wallis test results</span>
<span class="va">integration.compare.res</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  vals.to.compare.combined by combo.labels.combined
## Kruskal-Wallis chi-squared = 0, df = 1, p-value = 1</code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Values used in Kruskal-Wallis test</span>
<span class="va">integration.compare.res</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>##    vals.to.compare.combined combo.labels.combined
## 1              4.733168e-35      Signal 1 + 2 + 3
## 2              2.000248e-03      Signal 1 + 2 + 3
## 3              2.000248e-03      Signal 1 + 2 + 3
## 4              2.000248e-03      Signal 1 + 2 + 3
## 5              2.000248e-03      Signal 1 + 2 + 3
## 6              2.000248e-03      Signal 1 + 2 + 3
## 7              2.000248e-03      Signal 1 + 2 + 3
## 8              2.000248e-03      Signal 1 + 2 + 3
## 9              2.000248e-03      Signal 1 + 2 + 3
## 10             2.000248e-03      Signal 1 + 2 + 3
## 11             2.000248e-03      Signal 1 + 2 + 3
## 12             2.000248e-03          Signal 3 + 4
## 13             4.733168e-35          Signal 3 + 4</code></pre>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Compare integration for the 0.5-1.5 Hz bin. P-value should indicate</span>
<span class="co">#significant difference</span>
<span class="va">integration.compare.res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SingleBinPSDIntegrationOrDominantFreqComparison.html">SingleBinPSDIntegrationOrDominantFreqComparison</a></span><span class="op">(</span>
list.of.windows <span class="op">=</span> <span class="va">windows</span>,
name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
sampling_frequency <span class="op">=</span> <span class="fl">100</span>,
single.bin.boundary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.5</span><span class="op">)</span>,
integration.or.dominant.freq <span class="op">=</span> <span class="st">"integration"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10
## [1] 11
## [1] 1
## [1] 2</code></pre>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Kruskal-Wallis test results</span>
<span class="va">integration.compare.res2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  vals.to.compare.combined by combo.labels.combined
## Kruskal-Wallis chi-squared = 4.9091, df = 1, p-value = 0.02672</code></pre>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Values used in Kruskal-Wallis test</span>
<span class="va">integration.compare.res2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>##    vals.to.compare.combined combo.labels.combined
## 1               0.002000248      Signal 1 + 2 + 3
## 2               0.008000115      Signal 1 + 2 + 3
## 3               0.008000115      Signal 1 + 2 + 3
## 4               0.008000115      Signal 1 + 2 + 3
## 5               0.008000115      Signal 1 + 2 + 3
## 6               0.008000115      Signal 1 + 2 + 3
## 7               0.008000115      Signal 1 + 2 + 3
## 8               0.008000115      Signal 1 + 2 + 3
## 9               0.008000115      Signal 1 + 2 + 3
## 10              0.008000115      Signal 1 + 2 + 3
## 11              0.002000248      Signal 1 + 2 + 3
## 12              0.002000248          Signal 3 + 4
## 13              0.002000248          Signal 3 + 4</code></pre>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Dominant Frequency---------------------------------------------------------------------</span>

<span class="co">#Compare dominant frequency P-value should not indicate</span>
<span class="co">#significant difference</span>
<span class="va">integration.compare.res3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SingleBinPSDIntegrationOrDominantFreqComparison.html">SingleBinPSDIntegrationOrDominantFreqComparison</a></span><span class="op">(</span>
list.of.windows <span class="op">=</span> <span class="va">windows</span>,
name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
sampling_frequency <span class="op">=</span> <span class="fl">100</span>,
x_start <span class="op">=</span> <span class="fl">0</span>,
x_end <span class="op">=</span> <span class="fl">10</span>,
x_increment <span class="op">=</span> <span class="fl">0.01</span>,
integration.or.dominant.freq <span class="op">=</span> <span class="st">"dominant_freq"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10
## [1] 11
## [1] 1
## [1] 2</code></pre>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Kruskal-Wallis test results</span>
<span class="va">integration.compare.res3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  vals.to.compare.combined by combo.labels.combined
## Kruskal-Wallis chi-squared = 2.0083, df = 1, p-value = 0.1564</code></pre>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Values used in Kruskal-Wallis test</span>
<span class="va">integration.compare.res3</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>##    vals.to.compare.combined combo.labels.combined
## 1                         1      Signal 1 + 2 + 3
## 2                         1      Signal 1 + 2 + 3
## 3                         1      Signal 1 + 2 + 3
## 4                         1      Signal 1 + 2 + 3
## 5                         1      Signal 1 + 2 + 3
## 6                         1      Signal 1 + 2 + 3
## 7                         1      Signal 1 + 2 + 3
## 8                         1      Signal 1 + 2 + 3
## 9                         1      Signal 1 + 2 + 3
## 10                        1      Signal 1 + 2 + 3
## 11                        2      Signal 1 + 2 + 3
## 12                        2          Signal 3 + 4
## 13                        1          Signal 3 + 4</code></pre>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Compare dominant frequency P-value should indicate</span>
<span class="co">#significant difference</span>
<span class="va">integration.compare.res4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SingleBinPSDIntegrationOrDominantFreqComparison.html">SingleBinPSDIntegrationOrDominantFreqComparison</a></span><span class="op">(</span>
list.of.windows <span class="op">=</span> <span class="va">windows</span>,
name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">SecondComboToUse</span>, <span class="va">ThirdComboToUse</span><span class="op">)</span>,
level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Signal 3 + 4"</span>, <span class="st">"Signal 5"</span><span class="op">)</span>,
sampling_frequency <span class="op">=</span> <span class="fl">100</span>,
x_start <span class="op">=</span> <span class="fl">0</span>,
x_end <span class="op">=</span> <span class="fl">10</span>,
x_increment <span class="op">=</span> <span class="fl">0.01</span>,
integration.or.dominant.freq <span class="op">=</span> <span class="st">"dominant_freq"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5</code></pre>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Kruskal-Wallis test results</span>
<span class="va">integration.compare.res4</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  vals.to.compare.combined by combo.labels.combined
## Kruskal-Wallis chi-squared = 5.8333, df = 1, p-value = 0.01573</code></pre>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Values used in Kruskal-Wallis test</span>
<span class="va">integration.compare.res4</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>##   vals.to.compare.combined combo.labels.combined
## 1                        2          Signal 3 + 4
## 2                        1          Signal 3 + 4
## 3                        5              Signal 5
## 4                        5              Signal 5
## 5                        5              Signal 5
## 6                        5              Signal 5
## 7                        5              Signal 5</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Yong-Han Hank Cheng.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
