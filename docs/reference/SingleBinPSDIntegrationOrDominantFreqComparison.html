<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Given sets of windows (dataframes) corresponding to different combos, see if the integration
or dominant frequency of a specific frequency range is significantly different between the combos — SingleBinPSDIntegrationOrDominantFreqComparison • psdr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Given sets of windows (dataframes) corresponding to different combos, see if the integration
or dominant frequency of a specific frequency range is significantly different between the combos — SingleBinPSDIntegrationOrDominantFreqComparison" />
<meta property="og:description" content="Just for a single frequency bin: For Each combination in level.combinations,
generate the integral or dominant frequency for each
window of each combination. At this point, we should have vectors of
integrals or dominant frequency with each vector
corresponding to a different combo. Now we want to see if the integrals or dominant frequencies
in each combo significantly differ from the other combos. Kruskal-Wallis test is used
as a non-parametric ANOVA test to see if the combos have integrals or dominant frequencies that
are significantly different." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psdr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Examples.html">Examples</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Given sets of windows (dataframes) corresponding to different combos, see if the integration
or dominant frequency of a specific frequency range is significantly different between the combos</h1>
    
    <div class="hidden name"><code>SingleBinPSDIntegrationOrDominantFreqComparison.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Just for a single frequency bin: For Each combination in level.combinations,
generate the integral or dominant frequency for each
window of each combination. At this point, we should have vectors of
integrals or dominant frequency with each vector
corresponding to a different combo. Now we want to see if the integrals or dominant frequencies
in each combo significantly differ from the other combos. Kruskal-Wallis test is used
as a non-parametric ANOVA test to see if the combos have integrals or dominant frequencies that
are significantly different.</p>
    </div>

    <pre class="usage"><span class='fu'>SingleBinPSDIntegrationOrDominantFreqComparison</span><span class='op'>(</span>
  <span class='va'>list.of.windows</span>,
  <span class='va'>name.of.col.containing.time.series</span>,
  <span class='va'>level1.column.name</span>,
  <span class='va'>level2.column.name</span>,
  <span class='va'>level.combinations</span>,
  <span class='va'>level.combinations.labels</span>,
  <span class='va'>sampling_frequency</span>,
  single.bin.boundary <span class='op'>=</span> <span class='cn'>NULL</span>,
  x_start <span class='op'>=</span> <span class='cn'>NULL</span>,
  x_end <span class='op'>=</span> <span class='cn'>NULL</span>,
  x_increment <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>integration.or.dominant.freq</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>list.of.windows</th>
      <td><p>A list of windows (dataframes).</p></td>
    </tr>
    <tr>
      <th>name.of.col.containing.time.series</th>
      <td><p>A string that specifies the name of the column in the windows that correspond to the time series that should be used for making PSD.</p></td>
    </tr>
    <tr>
      <th>level1.column.name</th>
      <td><p>A String that specifies the column name to use for the first level. This column should only contain one unique value within each window.</p></td>
    </tr>
    <tr>
      <th>level2.column.name</th>
      <td><p>A String that specifies the column name to use for the second level. This column should only contain one unique value within each window.</p></td>
    </tr>
    <tr>
      <th>level.combinations</th>
      <td><p>A List containing Lists. Each list that it contains has two vectors. The first vector specifying the values for level1 and the second vector specifying the values for level2. Each list element will correspond to a new line on the plot.</p></td>
    </tr>
    <tr>
      <th>level.combinations.labels</th>
      <td><p>A vector of strings that labels each combination. This is used for naming the groups in integrals.with.combo.labels</p></td>
    </tr>
    <tr>
      <th>sampling_frequency</th>
      <td><p>Numeric value specifying sampling frequency in hertz. If data is sampled once every second, then sampling frequency is 1 Hz. If data is sampled once every 2 seconds, then sampling frequency is 0.5 Hz.</p></td>
    </tr>
    <tr>
      <th>single.bin.boundary</th>
      <td><p>A numeric vector with two elements. First element is the start frequency for the bin. Second element is the end frequency of the bin.</p></td>
    </tr>
    <tr>
      <th>x_start</th>
      <td><p>Numeric value specifying start of the new x-axis for the averaged PSD. Default is 0 Hz.</p></td>
    </tr>
    <tr>
      <th>x_end</th>
      <td><p>Numeric value specifying end of the new x-axis for the averaged PSD. Maximum value is the sampling_frequency divided by 2.</p></td>
    </tr>
    <tr>
      <th>x_increment</th>
      <td><p>Numeric value specifying increment of the new x-axis for the averaged PSD.</p></td>
    </tr>
    <tr>
      <th>integration.or.dominant.freq</th>
      <td><p>A string with two possible values for choosing whether integral or dominant frequency should be calculated and compared: "integration" or "dominant_freq".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with 3 objects:</p><ol>
<li><p>integrals.with.combo.labels: Dataframe used for statistical testing.</p></li>
<li><p>kruskal.test.res: Results from Kruskal-Willis testing.</p></li>
<li><p>pairwise.wilcox.rest.res: Results from pairwise Wilcoxo testing</p></li>
</ol>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Need to specify whether to compare integral or dominant frequency:
If integral (total power in frequency bin) is the value to compare, then
SingleBinPSDIntegrationForMultipleWindows() is used. If dominant frequency (
frequency corresponding to max PSD value in frequency bin) is the value to
compare, then PSDDominantFrequencyForMultipleWindows() is used.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>

<span class='co'>#Create a vector of time that represent times where data are sampled.</span>
<span class='va'>Fs</span> <span class='op'>=</span> <span class='fl'>100</span>; <span class='co'>#sampling frequency in Hz</span>
<span class='cn'>T</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='va'>Fs</span>; <span class='co'>#sampling period</span>
<span class='va'>L</span> <span class='op'>=</span> <span class='fl'>1000</span>; <span class='co'>#length of time vector</span>
<span class='va'>t</span> <span class='op'>=</span> <span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='op'>(</span><span class='va'>L</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='cn'>T</span>; <span class='co'>#time vector</span>

<span class='co'>#First signal</span>
<span class='co'>#1. 1 Hz with amplitude of 2</span>
<span class='va'>S1</span> <span class='op'>&lt;-</span> <span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span>
<span class='va'>level1.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>level2.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"1"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>S1.data.frame</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>S1</span>, <span class='va'>level1.vals</span>, <span class='va'>level2.vals</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>S1.data.frame</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Time"</span>, <span class='st'>"Signal"</span>, <span class='st'>"level1.ID"</span>, <span class='st'>"level2.ID"</span><span class='op'>)</span>
<span class='va'>S1.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>S1.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'>#Second signal</span>
<span class='co'>#1. 1 Hz with amplitude of -4</span>
<span class='co'>#2. 2 Hz with amplitude of -2</span>
<span class='va'>S2</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>-</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span>;
<span class='va'>level1.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>level2.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"2"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>S2.data.frame</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>S2</span>, <span class='va'>level1.vals</span>, <span class='va'>level2.vals</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>S2.data.frame</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Time"</span>, <span class='st'>"Signal"</span>, <span class='st'>"level1.ID"</span>, <span class='st'>"level2.ID"</span><span class='op'>)</span>
<span class='va'>S2.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>S2.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'>#Third signal</span>
<span class='co'>#1. 1 Hz with amplitude of 2</span>
<span class='co'>#2. 2 Hz with amplitude of 2</span>
<span class='va'>S3</span> <span class='op'>&lt;-</span> <span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span>;
<span class='va'>level1.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>level2.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"3"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>S3.data.frame</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>S3</span>, <span class='va'>level1.vals</span>, <span class='va'>level2.vals</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>S3.data.frame</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Time"</span>, <span class='st'>"Signal"</span>, <span class='st'>"level1.ID"</span>, <span class='st'>"level2.ID"</span><span class='op'>)</span>
<span class='va'>S3.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>S3.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'>#Fourth signal</span>
<span class='co'>#1. 1 Hz with amplitude of -2</span>
<span class='va'>S4</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span>
<span class='va'>level1.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"b"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>level2.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"3"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>S4.data.frame</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>S4</span>, <span class='va'>level1.vals</span>, <span class='va'>level2.vals</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>S4.data.frame</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Time"</span>, <span class='st'>"Signal"</span>, <span class='st'>"level1.ID"</span>, <span class='st'>"level2.ID"</span><span class='op'>)</span>
<span class='va'>S4.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>S4.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'>#Fifth signal</span>
<span class='co'>#1. 5 Hz with amplitude of -2</span>
<span class='va'>S5</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>5</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span>
<span class='va'>level1.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"c"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>level2.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"1"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>S5.data.frame</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>S5</span>, <span class='va'>level1.vals</span>, <span class='va'>level2.vals</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>S5.data.frame</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Time"</span>, <span class='st'>"Signal"</span>, <span class='st'>"level1.ID"</span>, <span class='st'>"level2.ID"</span><span class='op'>)</span>
<span class='va'>S5.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>S5.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'>#Extra representation of S2 dataframe to show an example that has enough samples</span>
<span class='co'>#to have significance for Kruskal-Wallis test</span>
<span class='va'>windows</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>S1.data.frame</span>, <span class='va'>S2.data.frame</span>, <span class='va'>S2.data.frame</span>, <span class='va'>S2.data.frame</span>, <span class='va'>S2.data.frame</span>,
<span class='va'>S2.data.frame</span>, <span class='va'>S2.data.frame</span>, <span class='va'>S2.data.frame</span>, <span class='va'>S2.data.frame</span>, <span class='va'>S2.data.frame</span>, <span class='va'>S3.data.frame</span>,
<span class='va'>S4.data.frame</span>,
<span class='va'>S5.data.frame</span>, <span class='va'>S5.data.frame</span>, <span class='va'>S5.data.frame</span>, <span class='va'>S5.data.frame</span>, <span class='va'>S5.data.frame</span><span class='op'>)</span>

<span class='co'>#Gets the composite of the first, second, and third signal. Should result in a flat signal.</span>
<span class='va'>FirstComboToUse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span> <span class='op'>)</span>

<span class='co'>#Gets the composite of the third and fourth signal</span>
<span class='va'>SecondComboToUse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>)</span>

<span class='co'>#Gets the composite of fifth signal</span>
<span class='va'>ThirdComboToUse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"c"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>)</span>


<span class='co'>#PSD-------------------------------------------------------------------------</span>

<span class='va'>PSD.results</span> <span class='op'>&lt;-</span> <span class='fu'><a href='AutomatedCompositePlotting.html'>AutomatedCompositePlotting</a></span><span class='op'>(</span>list.of.windows <span class='op'>=</span> <span class='va'>windows</span>,
                           name.of.col.containing.time.series <span class='op'>=</span> <span class='st'>"Signal"</span>,
                           x_start <span class='op'>=</span> <span class='fl'>0</span>,
                           x_end <span class='op'>=</span> <span class='fl'>10</span>,
                           x_increment <span class='op'>=</span> <span class='fl'>0.01</span>,
                           level1.column.name <span class='op'>=</span> <span class='st'>"level1.ID"</span>,
                           level2.column.name <span class='op'>=</span> <span class='st'>"level2.ID"</span>,
                           level.combinations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>FirstComboToUse</span>,
                                                    <span class='va'>SecondComboToUse</span>,
                                                    <span class='va'>ThirdComboToUse</span><span class='op'>)</span>,
                           level.combinations.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Signal 1 + 2 + 3"</span>,
                                                         <span class='st'>"Signal 3 + 4"</span>,
                                                         <span class='st'>"Signal 5"</span><span class='op'>)</span>,
                           plot.title <span class='op'>=</span> <span class='st'>"Example"</span>,
                           plot.xlab <span class='op'>=</span> <span class='st'>"Hz"</span>,
                           plot.ylab <span class='op'>=</span> <span class='st'>"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class='op'>=</span> <span class='fl'>2</span>,
                           TimeSeries.PSD.LogPSD <span class='op'>=</span> <span class='st'>"PSD"</span>,
                           sampling_frequency <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: cannot compute exact p-value with ties</span></div><div class='output co'>#&gt; <span class='warning'>Warning: cannot compute exact p-value with ties</span></div><div class='output co'>#&gt; <span class='warning'>Warning: cannot compute exact p-value with ties</span></div><div class='input'>
<span class='va'>ggplot.obj.PSD</span> <span class='op'>&lt;-</span> <span class='va'>PSD.results</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>

<span class='co'>#Integration-------------------------------------------------------------------------</span>

<span class='co'>#Compare integration for the 1.5-2.5 Hz bin. P-value should not indicate</span>
<span class='co'>#significant difference</span>
<span class='va'>integration.compare.res</span> <span class='op'>&lt;-</span> <span class='fu'>SingleBinPSDIntegrationOrDominantFreqComparison</span><span class='op'>(</span>
list.of.windows <span class='op'>=</span> <span class='va'>windows</span>,
name.of.col.containing.time.series <span class='op'>=</span> <span class='st'>"Signal"</span>,
level1.column.name <span class='op'>=</span> <span class='st'>"level1.ID"</span>,
level2.column.name <span class='op'>=</span> <span class='st'>"level2.ID"</span>,
level.combinations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>FirstComboToUse</span>, <span class='va'>SecondComboToUse</span><span class='op'>)</span>,
level.combinations.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Signal 1 + 2 + 3"</span>, <span class='st'>"Signal 3 + 4"</span><span class='op'>)</span>,
sampling_frequency <span class='op'>=</span> <span class='fl'>100</span>,
single.bin.boundary <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.5</span>, <span class='fl'>2.5</span><span class='op'>)</span>,
integration.or.dominant.freq <span class='op'>=</span> <span class='st'>"integration"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: cannot compute exact p-value with ties</span></div><div class='input'>
<span class='co'>#Kruskal-Wallis test results</span>
<span class='va'>integration.compare.res</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt; 
#&gt; 	Kruskal-Wallis rank sum test
#&gt; 
#&gt; data:  vals.to.compare.combined by combo.labels.combined
#&gt; Kruskal-Wallis chi-squared = 0, df = 1, p-value = 1
#&gt; </div><div class='input'>
<span class='co'>#Compare integration for the 0.5-1.5 Hz bin. P-value should indicate</span>
<span class='co'>#significant difference</span>
<span class='va'>integration.compare.res2</span> <span class='op'>&lt;-</span> <span class='fu'>SingleBinPSDIntegrationOrDominantFreqComparison</span><span class='op'>(</span>
list.of.windows <span class='op'>=</span> <span class='va'>windows</span>,
name.of.col.containing.time.series <span class='op'>=</span> <span class='st'>"Signal"</span>,
level1.column.name <span class='op'>=</span> <span class='st'>"level1.ID"</span>,
level2.column.name <span class='op'>=</span> <span class='st'>"level2.ID"</span>,
level.combinations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>FirstComboToUse</span>, <span class='va'>SecondComboToUse</span><span class='op'>)</span>,
level.combinations.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Signal 1 + 2 + 3"</span>, <span class='st'>"Signal 3 + 4"</span><span class='op'>)</span>,
sampling_frequency <span class='op'>=</span> <span class='fl'>100</span>,
single.bin.boundary <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>,<span class='fl'>1.5</span><span class='op'>)</span>,
integration.or.dominant.freq <span class='op'>=</span> <span class='st'>"integration"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: cannot compute exact p-value with ties</span></div><div class='input'>
<span class='co'>#Kruskal-Wallis test results</span>
<span class='va'>integration.compare.res2</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt; 
#&gt; 	Kruskal-Wallis rank sum test
#&gt; 
#&gt; data:  vals.to.compare.combined by combo.labels.combined
#&gt; Kruskal-Wallis chi-squared = 4.9091, df = 1, p-value = 0.02672
#&gt; </div><div class='input'>


<span class='co'>#Dominant Frequency---------------------------------------------------------------------</span>

<span class='co'>#Compare dominant frequency P-value should not indicate</span>
<span class='co'>#significant difference</span>
<span class='va'>integration.compare.res3</span> <span class='op'>&lt;-</span> <span class='fu'>SingleBinPSDIntegrationOrDominantFreqComparison</span><span class='op'>(</span>
list.of.windows <span class='op'>=</span> <span class='va'>windows</span>,
name.of.col.containing.time.series <span class='op'>=</span> <span class='st'>"Signal"</span>,
level1.column.name <span class='op'>=</span> <span class='st'>"level1.ID"</span>,
level2.column.name <span class='op'>=</span> <span class='st'>"level2.ID"</span>,
level.combinations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>FirstComboToUse</span>, <span class='va'>SecondComboToUse</span><span class='op'>)</span>,
level.combinations.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Signal 1 + 2 + 3"</span>, <span class='st'>"Signal 3 + 4"</span><span class='op'>)</span>,
sampling_frequency <span class='op'>=</span> <span class='fl'>100</span>,
x_start <span class='op'>=</span> <span class='fl'>0</span>,
x_end <span class='op'>=</span> <span class='fl'>10</span>,
x_increment <span class='op'>=</span> <span class='fl'>0.01</span>,
integration.or.dominant.freq <span class='op'>=</span> <span class='st'>"dominant_freq"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: cannot compute exact p-value with ties</span></div><div class='input'>
<span class='co'>#Kruskal-Wallis test results</span>
<span class='va'>integration.compare.res3</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt; 
#&gt; 	Kruskal-Wallis rank sum test
#&gt; 
#&gt; data:  vals.to.compare.combined by combo.labels.combined
#&gt; Kruskal-Wallis chi-squared = 2.0083, df = 1, p-value = 0.1564
#&gt; </div><div class='input'>

<span class='co'>#Compare dominant frequency P-value should indicate</span>
<span class='co'>#significant difference</span>
<span class='va'>integration.compare.res4</span> <span class='op'>&lt;-</span> <span class='fu'>SingleBinPSDIntegrationOrDominantFreqComparison</span><span class='op'>(</span>
list.of.windows <span class='op'>=</span> <span class='va'>windows</span>,
name.of.col.containing.time.series <span class='op'>=</span> <span class='st'>"Signal"</span>,
level1.column.name <span class='op'>=</span> <span class='st'>"level1.ID"</span>,
level2.column.name <span class='op'>=</span> <span class='st'>"level2.ID"</span>,
level.combinations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>SecondComboToUse</span>, <span class='va'>ThirdComboToUse</span><span class='op'>)</span>,
level.combinations.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Signal 3 + 4"</span>, <span class='st'>"Signal 5"</span><span class='op'>)</span>,
sampling_frequency <span class='op'>=</span> <span class='fl'>100</span>,
x_start <span class='op'>=</span> <span class='fl'>0</span>,
x_end <span class='op'>=</span> <span class='fl'>10</span>,
x_increment <span class='op'>=</span> <span class='fl'>0.01</span>,
integration.or.dominant.freq <span class='op'>=</span> <span class='st'>"dominant_freq"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: cannot compute exact p-value with ties</span></div><div class='input'>
<span class='co'>#Kruskal-Wallis test results</span>
<span class='va'>integration.compare.res4</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt; 
#&gt; 	Kruskal-Wallis rank sum test
#&gt; 
#&gt; data:  vals.to.compare.combined by combo.labels.combined
#&gt; Kruskal-Wallis chi-squared = 5.8333, df = 1, p-value = 0.01573
#&gt; </div><div class='input'><span class='co'>#Values used in comparison of the two groups</span>
<span class='va'>integration.compare.res4</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt;   vals.to.compare.combined combo.labels.combined
#&gt; 1                        2          Signal 3 + 4
#&gt; 2                        1          Signal 3 + 4
#&gt; 3                        5              Signal 5
#&gt; 4                        5              Signal 5
#&gt; 5                        5              Signal 5
#&gt; 6                        5              Signal 5
#&gt; 7                        5              Signal 5</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Yong-Han Hank Cheng.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


