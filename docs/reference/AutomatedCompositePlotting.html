<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Automated plotting of time series, PSD, and log transformed PSD. — AutomatedCompositePlotting • psdr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Automated plotting of time series, PSD, and log transformed PSD. — AutomatedCompositePlotting" />
<meta property="og:description" content="This function uses a lot of the functions in this package (psdr) to automate the
plotting process for plotting composite curves and having multiple curves
on the same plot." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psdr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Examples.html">Examples</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Automated plotting of time series, PSD, and log transformed PSD.</h1>
    
    <div class="hidden name"><code>AutomatedCompositePlotting.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses a lot of the functions in this package (psdr) to automate the
plotting process for plotting composite curves and having multiple curves
on the same plot.</p>
    </div>

    <pre class="usage"><span class='fu'>AutomatedCompositePlotting</span><span class='op'>(</span>
  <span class='va'>list.of.windows</span>,
  <span class='va'>name.of.col.containing.time.series</span>,
  x_start <span class='op'>=</span> <span class='fl'>0</span>,
  <span class='va'>x_end</span>,
  <span class='va'>x_increment</span>,
  <span class='va'>level1.column.name</span>,
  <span class='va'>level2.column.name</span>,
  <span class='va'>level.combinations</span>,
  <span class='va'>level.combinations.labels</span>,
  <span class='va'>plot.title</span>,
  <span class='va'>plot.xlab</span>,
  <span class='va'>plot.ylab</span>,
  combination.index.for.envelope <span class='op'>=</span> <span class='cn'>NULL</span>,
  TimeSeries.PSD.LogPSD <span class='op'>=</span> <span class='st'>"TimeSeries"</span>,
  sampling_frequency <span class='op'>=</span> <span class='cn'>NULL</span>,
  my.colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>, <span class='st'>"red"</span>, <span class='st'>"black"</span>, <span class='st'>"green"</span>, <span class='st'>"gold"</span>, <span class='st'>"darkorchid1"</span>, <span class='st'>"brown"</span>,
    <span class='st'>"deeppink"</span>, <span class='st'>"gray"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>list.of.windows</th>
      <td><p>A list of windows (dataframes). All windows should have the same length, but because interpolation is used, the function still works if window length differs.</p></td>
    </tr>
    <tr>
      <th>name.of.col.containing.time.series</th>
      <td><p>A string that specifies the name of the column in the windows that correspond to the time series that should be used.</p></td>
    </tr>
    <tr>
      <th>x_start</th>
      <td><p>Numeric value specifying start of the new x-axis. Default is 0.</p></td>
    </tr>
    <tr>
      <th>x_end</th>
      <td><p>Numeric value specifying end of the new x-axis. For PSD, maximum value is the sampling_frequency divided by 2.</p></td>
    </tr>
    <tr>
      <th>x_increment</th>
      <td><p>Numeric value specifying increment of the new x-axis.</p></td>
    </tr>
    <tr>
      <th>level1.column.name</th>
      <td><p>A String that specifies the column name to use for the first level. This column should only contain one unique value within each window.</p></td>
    </tr>
    <tr>
      <th>level2.column.name</th>
      <td><p>A String that specifies the column name to use for the second level. This column should only contain one unique value within each window.</p></td>
    </tr>
    <tr>
      <th>level.combinations</th>
      <td><p>A List containing Lists. Each list that it contains has two vectors. The first vector specifying the values for level1 and the second vector specifying the values for level2. Each list element will correspond to a new line on the plot.</p></td>
    </tr>
    <tr>
      <th>level.combinations.labels</th>
      <td><p>A vector of strings that labels each combination. This is used for making the figure legend.</p></td>
    </tr>
    <tr>
      <th>plot.title</th>
      <td><p>String for title of plot.</p></td>
    </tr>
    <tr>
      <th>plot.xlab</th>
      <td><p>String for x-axis of plot.</p></td>
    </tr>
    <tr>
      <th>plot.ylab</th>
      <td><p>String for y-axis of plot.</p></td>
    </tr>
    <tr>
      <th>combination.index.for.envelope</th>
      <td><p>A numeric value that specifies which combination (index of level.combinations) should have a line with an error envelope. The default is no envelope.</p></td>
    </tr>
    <tr>
      <th>TimeSeries.PSD.LogPSD</th>
      <td><p>A String with 3 possible values to specify what type of plot to create from the time series: 1. "TimeSeries", 2. "PSD", 3. "LogPSD"</p></td>
    </tr>
    <tr>
      <th>sampling_frequency</th>
      <td><p>Numeric value used for specifying sampling frequency if PSD or LogPSD is made with this function. Default is NULL because default plot created is a time series plot.</p></td>
    </tr>
    <tr>
      <th>my.colors</th>
      <td><p>A vector of strings that specify the color for each line. 9 default values are used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A List with three objects:</p><ol>
<li><p>A List of dataframes containing values for each line on the plot. The order of the dataframes correspond to the order of the combinations in level.combinations.</p></li>
<li><p>A ggplot object that can be plotted right away.</p></li>
<li><p>If plot selected is a PSD, then a List is outputted from
SingleBinPSDIntegrationOrDominantFreqComparison() to compare
dominant frequencies between combinations.</p></li>
</ol>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Given a list of windows, you can specify which windows you want to average together
to form a curve on the plot. You can specify multiple combos and therefore multiple
curves can be plotted on the same plot with a legend to specify the combo
used to create each curve. An error envelope can also be created for a single curve
on the plot.</p>
<p>The function automatically generates a ggplot
for easy plotting. However, the function also outputs dataframes for each combo.
Each dataframe has 3 columns:</p><ol>
<li><p>X value: For timeseries, this will be in the original units that separates
each observation in the time series. For example, if there are 150 observations
and each observation is 0.02 seconds apart, then if 150 observations are
specified as the x_increment, then each observation are still 0.02 seconds.
The time difference between the first and last observation needs to equal the
time difference between the first and last observation in the original time series.
For PSD and LogPSd, the units will be in Hz (frequency). The frequency range
depends on the sampling frequency. Smallest frequency is 0 and largest frequency
is sampling_frequency/2.</p></li>
<li><p>Y value: For time series, this will be in the original units of the time series.
For PSD, the units will be (original units)^2/Hz, for LogPSD, the units will be
log((original units)^2/Hz)).</p></li>
<li><p>Standard deviation of Y value. This can be used to plot error bars
or error envelopes to see the spread of the windows used to make the composite.</p></li>
</ol>

<p>Three different plots can be created:</p><ol>
<li><p>Time series plot. This simply takes the time series in the windows, averages them for each combo, and then plots the composite curve for each combo.</p></li>
<li><p>PSD plot. This takes the time series in the windows and given the sampling frequency, it calculates the PSD. It averages the PSD for the windows in each combo, and then plots the composite curve for each combo.</p></li>
<li><p>Log transformed PSD plot. Same as PSD plot except at the end, the composite PSD curves are log transformed.</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>#I want to create a plot that shows two curves:</span>
<span class='co'>#1. Composite of time series signals 1, 2, and 3.</span>
<span class='co'>#2. Composite of time series signals 3 and 4.</span>

<span class='co'>#Create a vector of time that represent times where data are sampled.</span>
<span class='va'>Fs</span> <span class='op'>=</span> <span class='fl'>100</span>; <span class='co'>#sampling frequency in Hz</span>
<span class='cn'>T</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='va'>Fs</span>; <span class='co'>#sampling period</span>
<span class='va'>L</span> <span class='op'>=</span> <span class='fl'>1000</span>; <span class='co'>#length of time vector</span>
<span class='va'>t</span> <span class='op'>=</span> <span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='op'>(</span><span class='va'>L</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='cn'>T</span>; <span class='co'>#time vector</span>

<span class='co'>#First signal</span>
<span class='co'>#1. 1 Hz with amplitude of 2</span>
<span class='va'>S1</span> <span class='op'>&lt;-</span> <span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span>
<span class='va'>level1.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>level2.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"1"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>S1.data.frame</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>S1</span>, <span class='va'>level1.vals</span>, <span class='va'>level2.vals</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>S1.data.frame</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Time"</span>, <span class='st'>"Signal"</span>, <span class='st'>"level1.ID"</span>, <span class='st'>"level2.ID"</span><span class='op'>)</span>
<span class='va'>S1.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>S1.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'>#Second signal</span>
<span class='co'>#1. 1 Hz with amplitude of -4</span>
<span class='co'>#2. 2 Hz with amplitude of -2</span>
<span class='va'>S2</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>-</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span>;
<span class='va'>level1.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>level2.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"2"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>S2.data.frame</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>S2</span>, <span class='va'>level1.vals</span>, <span class='va'>level2.vals</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>S2.data.frame</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Time"</span>, <span class='st'>"Signal"</span>, <span class='st'>"level1.ID"</span>, <span class='st'>"level2.ID"</span><span class='op'>)</span>
<span class='va'>S2.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>S2.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'>#Third signal</span>
<span class='co'>#1. 1 Hz with amplitude of 2</span>
<span class='co'>#2. 2 Hz with amplitude of 2</span>
<span class='va'>S3</span> <span class='op'>&lt;-</span> <span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span>;
<span class='va'>level1.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>level2.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"3"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>S3.data.frame</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>S3</span>, <span class='va'>level1.vals</span>, <span class='va'>level2.vals</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>S3.data.frame</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Time"</span>, <span class='st'>"Signal"</span>, <span class='st'>"level1.ID"</span>, <span class='st'>"level2.ID"</span><span class='op'>)</span>
<span class='va'>S3.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>S3.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'>#Fourth signal</span>
<span class='co'>#1. 1 Hz with amplitude of -2</span>
<span class='va'>S4</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>*</span><span class='fl'>1</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span>
<span class='va'>level1.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"b"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>level2.vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"3"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>S4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>S4.data.frame</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>S4</span>, <span class='va'>level1.vals</span>, <span class='va'>level2.vals</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>S4.data.frame</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Time"</span>, <span class='st'>"Signal"</span>, <span class='st'>"level1.ID"</span>, <span class='st'>"level2.ID"</span><span class='op'>)</span>
<span class='va'>S4.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>S4.data.frame</span><span class='op'>[</span>,<span class='st'>"Signal"</span><span class='op'>]</span><span class='op'>)</span>

<span class='va'>windows</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>S1.data.frame</span>, <span class='va'>S2.data.frame</span>, <span class='va'>S3.data.frame</span>, <span class='va'>S4.data.frame</span><span class='op'>)</span>

<span class='co'>#Gets the composite of the first, second, and third signal. Should result in a flat signal.</span>
<span class='va'>FirstComboToUse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span> <span class='op'>)</span>

<span class='co'>#Gets the composite of the third and fourth signal</span>
<span class='va'>SecondComboToUse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>)</span>


<span class='co'>#Timeseries-----------------------------------------------------------------</span>

<span class='va'>timeseries.results</span> <span class='op'>&lt;-</span> <span class='fu'>AutomatedCompositePlotting</span><span class='op'>(</span>list.of.windows <span class='op'>=</span> <span class='va'>windows</span>,
                           name.of.col.containing.time.series <span class='op'>=</span> <span class='st'>"Signal"</span>,
                           x_start <span class='op'>=</span> <span class='fl'>0</span>,
                           x_end <span class='op'>=</span> <span class='fl'>999</span>,
                           x_increment <span class='op'>=</span> <span class='fl'>1</span>,
                           level1.column.name <span class='op'>=</span> <span class='st'>"level1.ID"</span>,
                           level2.column.name <span class='op'>=</span> <span class='st'>"level2.ID"</span>,
                           level.combinations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>FirstComboToUse</span>, <span class='va'>SecondComboToUse</span><span class='op'>)</span>,
                           level.combinations.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Signal 1 + 2 + 3"</span>, <span class='st'>"Signal 3 + 4"</span><span class='op'>)</span>,
                           plot.title <span class='op'>=</span> <span class='st'>"Example"</span>,
                           plot.xlab <span class='op'>=</span> <span class='st'>"Time"</span>,
                           plot.ylab <span class='op'>=</span> <span class='st'>"Original units"</span>,
                           combination.index.for.envelope <span class='op'>=</span> <span class='cn'>NULL</span>,
                           TimeSeries.PSD.LogPSD <span class='op'>=</span> <span class='st'>"TimeSeries"</span>,
                           sampling_frequency <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 1
#&gt; [1] 2</div><div class='input'>
<span class='va'>ggplot.obj.timeseries</span> <span class='op'>&lt;-</span> <span class='va'>timeseries.results</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>

<span class='co'>#Plot. Will see the 1+2+3 curve as a flat line. The 3+4 curve will only have 2 Hz.</span>
<span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.new</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ggplot.obj.timeseries</span>

<span class='co'>#PSD-------------------------------------------------------------------------</span>

<span class='co'>#Note that the PSDs are not generated directly from the "Signal 1 + 2 + 3" and</span>
<span class='co'>#the "Signal 3 + 4" time series. Instead, PSDs are generated individually</span>
<span class='co'>#for signals 1, 2, 3, and 4, and then then are summed together.</span>

<span class='va'>PSD.results</span> <span class='op'>&lt;-</span> <span class='fu'>AutomatedCompositePlotting</span><span class='op'>(</span>list.of.windows <span class='op'>=</span> <span class='va'>windows</span>,
                           name.of.col.containing.time.series <span class='op'>=</span> <span class='st'>"Signal"</span>,
                           x_start <span class='op'>=</span> <span class='fl'>0</span>,
                           x_end <span class='op'>=</span> <span class='fl'>50</span>,
                           x_increment <span class='op'>=</span> <span class='fl'>0.01</span>,
                           level1.column.name <span class='op'>=</span> <span class='st'>"level1.ID"</span>,
                           level2.column.name <span class='op'>=</span> <span class='st'>"level2.ID"</span>,
                           level.combinations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>FirstComboToUse</span>, <span class='va'>SecondComboToUse</span><span class='op'>)</span>,
                           level.combinations.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Signal 1 + 2 + 3"</span>, <span class='st'>"Signal 3 + 4"</span><span class='op'>)</span>,
                           plot.title <span class='op'>=</span> <span class='st'>"Example"</span>,
                           plot.xlab <span class='op'>=</span> <span class='st'>"Hz"</span>,
                           plot.ylab <span class='op'>=</span> <span class='st'>"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class='op'>=</span> <span class='fl'>2</span>,
                           TimeSeries.PSD.LogPSD <span class='op'>=</span> <span class='st'>"PSD"</span>,
                           sampling_frequency <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 1
#&gt; [1] 2</div><div class='output co'>#&gt; <span class='warning'>Warning: cannot compute exact p-value with ties</span></div><div class='input'>
<span class='va'>ggplot.obj.PSD</span> <span class='op'>&lt;-</span> <span class='va'>PSD.results</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>

<span class='co'>#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should be</span>
<span class='co'>#stronger in both cases because more signals have this frequency (even if amp is negative).</span>
<span class='co'>#Error envelope is specified for the second (red) curve. Envelope should only</span>
<span class='co'>#be present for 2 Hz signal.</span>
<span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.new</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ggplot.obj.PSD</span>

<span class='co'>#PSD Zoomed in---------------------------------------------------------------</span>

<span class='va'>PSD.results</span> <span class='op'>&lt;-</span> <span class='fu'>AutomatedCompositePlotting</span><span class='op'>(</span>list.of.windows <span class='op'>=</span> <span class='va'>windows</span>,
                           name.of.col.containing.time.series <span class='op'>=</span> <span class='st'>"Signal"</span>,
                           x_start <span class='op'>=</span> <span class='fl'>0</span>,
                           x_end <span class='op'>=</span> <span class='fl'>5</span>,
                           x_increment <span class='op'>=</span> <span class='fl'>0.01</span>,
                           level1.column.name <span class='op'>=</span> <span class='st'>"level1.ID"</span>,
                           level2.column.name <span class='op'>=</span> <span class='st'>"level2.ID"</span>,
                           level.combinations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>FirstComboToUse</span>, <span class='va'>SecondComboToUse</span><span class='op'>)</span>,
                           level.combinations.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Signal 1 + 2 + 3"</span>, <span class='st'>"Signal 3 + 4"</span><span class='op'>)</span>,
                           plot.title <span class='op'>=</span> <span class='st'>"Example"</span>,
                           plot.xlab <span class='op'>=</span> <span class='st'>"Hz"</span>,
                           plot.ylab <span class='op'>=</span> <span class='st'>"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class='op'>=</span> <span class='fl'>2</span>,
                           TimeSeries.PSD.LogPSD <span class='op'>=</span> <span class='st'>"PSD"</span>,
                           sampling_frequency <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 1
#&gt; [1] 2</div><div class='output co'>#&gt; <span class='warning'>Warning: cannot compute exact p-value with ties</span></div><div class='input'>
<span class='va'>ggplot.obj.PSD</span> <span class='op'>&lt;-</span> <span class='va'>PSD.results</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>

<span class='co'>#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should be</span>
<span class='co'>#stronger in both cases because more signals have this frequency (even if amp is negative).</span>
<span class='co'>#Error envelope is specified for the second (red) curve. Envelope should only</span>
<span class='co'>#be present for 1 Hz signal.</span>
<span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.new</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ggplot.obj.PSD</span>

<span class='co'>#LogPSD-------------------------------------------------------------------------</span>

<span class='va'>LogPSD.results</span> <span class='op'>&lt;-</span> <span class='fu'>AutomatedCompositePlotting</span><span class='op'>(</span>list.of.windows <span class='op'>=</span> <span class='va'>windows</span>,
                           name.of.col.containing.time.series <span class='op'>=</span> <span class='st'>"Signal"</span>,
                           x_start <span class='op'>=</span> <span class='fl'>0</span>,
                           x_end <span class='op'>=</span> <span class='fl'>50</span>,
                           x_increment <span class='op'>=</span> <span class='fl'>0.01</span>,
                           level1.column.name <span class='op'>=</span> <span class='st'>"level1.ID"</span>,
                           level2.column.name <span class='op'>=</span> <span class='st'>"level2.ID"</span>,
                           level.combinations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>FirstComboToUse</span>, <span class='va'>SecondComboToUse</span><span class='op'>)</span>,
                           level.combinations.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Signal 1 + 2 + 3"</span>, <span class='st'>"Signal 3 + 4"</span><span class='op'>)</span>,
                           plot.title <span class='op'>=</span> <span class='st'>"Example"</span>,
                           plot.xlab <span class='op'>=</span> <span class='st'>"Hz"</span>,
                           plot.ylab <span class='op'>=</span> <span class='st'>"log((Original units)^2/Hz)"</span>,
                           combination.index.for.envelope <span class='op'>=</span> <span class='cn'>NULL</span>,
                           TimeSeries.PSD.LogPSD <span class='op'>=</span> <span class='st'>"LogPSD"</span>,
                           sampling_frequency <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 1
#&gt; [1] 2</div><div class='input'>
<span class='va'>ggplot.obj.LogPSD</span> <span class='op'>&lt;-</span> <span class='va'>LogPSD.results</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>

<span class='co'>#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should</span>
<span class='co'>#be stronger in both cases because more signals have this frequency (even if amp is negative).</span>
<span class='co'>#Error envelope is specified for the second (red) curve. Envelope should only</span>
<span class='co'>#be present for 2 Hz signal.</span>
<span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.new</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ggplot.obj.LogPSD</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Yong-Han Hank Cheng.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


